"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9521],{780:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var a=n(3117),r=(n(7294),n(3905));const i={title:"Review Workflows",description:"Guide for review workflows in the content-manager.",tags:["content-manager","review-workflows"]},o=void 0,s={unversionedId:"docs/core/content-manager/review-workflows",id:"docs/core/content-manager/review-workflows",title:"Review Workflows",description:"Guide for review workflows in the content-manager.",source:"@site/docs/docs/01-core/content-manager/02-review-workflows.mdx",sourceDirName:"docs/01-core/content-manager",slug:"/docs/core/content-manager/review-workflows",permalink:"/docs/core/content-manager/review-workflows",draft:!1,editUrl:"https://github.com/strapi/strapi/tree/main/docs/docs/docs/01-core/content-manager/02-review-workflows.mdx",tags:[{label:"content-manager",permalink:"/tags/content-manager"},{label:"review-workflows",permalink:"/tags/review-workflows"}],version:"current",sidebarPosition:2,frontMatter:{title:"Review Workflows",description:"Guide for review workflows in the content-manager.",tags:["content-manager","review-workflows"]},sidebar:"docs",previous:{title:"Relations",permalink:"/docs/core/content-manager/relations"},next:{title:"useContentTypes",permalink:"/docs/core/content-manager/hooks/use-content-types"}},l={},d=[{value:"Summary",id:"summary",level:2},{value:"List view",id:"list-view",level:3},{value:"Edit view",id:"edit-view",level:3},{value:"Default stage",id:"default-stage",level:2},{value:"Stage assignments",id:"stage-assignments",level:3},{value:"Nullish stages",id:"nullish-stages",level:3},{value:"List view",id:"list-view-1",level:2},{value:"Edit View",id:"edit-view-1",level:2},{value:"Endpoints",id:"endpoints",level:3},{value:"<code>PUT /admin/content-manager/[kind]/[content-type-uid]/[entity-id]/stage</code>",id:"put-admincontent-managerkindcontent-type-uidentity-idstage",level:4},{value:"Payload",id:"payload",level:5}],p={toc:d};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"summary"},"Summary"),(0,r.kt)("p",null,"Review workflows are disabled for all content-types by default and have to be enabled for each of them. More about how to ",(0,r.kt)("a",{parentName:"p",href:"/content-type-builder/review-workflows"},"enable review-workflows for a content-type"),"."),(0,r.kt)("p",null,"The feature is visible in two locations of the content-manager:"),(0,r.kt)("h3",{id:"list-view"},"List view"),(0,r.kt)("p",null,"If the feature is enabled for a content-type a new column will show up, displaying the current stage. If no stage was assigned to an entity,\nthe column is displayed as empty."),(0,r.kt)("h3",{id:"edit-view"},"Edit view"),(0,r.kt)("p",null,"If the feature is enabled for a content-type the currently selected stage will show up in the information sidebar next to the edit view. Users\ncan select any other stage of the current workflow."),(0,r.kt)("p",null,"Stage assignments are decoupled from entities, meaning that updating an entity won't set the selected stage. Instead the stage select\ncomponent will trigger an atomic update using the admin API to assign/ update a stage to the current entity, when a new value is selected.\nBecause of this decoupling stages ",(0,r.kt)("strong",{parentName:"p"},"can not be assigned on entity creation")," and only after the have been created."),(0,r.kt)("p",null,"If no stage was assigned to the current entity the select component displays and error and asks a user to select a stage."),(0,r.kt)("h2",{id:"default-stage"},"Default stage"),(0,r.kt)("p",null,"By default every entity which is part of a content-type with review workflows enabled, will get the first stage of the attached workflow\nassigned upon creation via the ",(0,r.kt)("strong",{parentName:"p"},"admin API"),", ",(0,r.kt)("strong",{parentName:"p"},"content API")," and the ",(0,r.kt)("strong",{parentName:"p"},"entity Service"),"."),(0,r.kt)("h3",{id:"stage-assignments"},"Stage assignments"),(0,r.kt)("p",null,"The default stage is assigned upon entity creation. In the bootstrap phase of Strapi all entities that do not have a stage assigned\n(and are part of a content-type which has the feature enabled) will have the default stage assigned. Initially this was meant as the\nmigration when the feature is enabled for the first time to ensure all entities, but became also a safety-net for entities\nthat do not have a stage set."),(0,r.kt)("h3",{id:"nullish-stages"},"Nullish stages"),(0,r.kt)("p",null,"Entities which are not created through the admin API, content API or entity service will not have a stage assigned by default (e.g. lifecycle methods).\nIf entities are created through more low-level ways, developers need to take care to assign a stage individually."),(0,r.kt)("p",null,"This means at any place where the UI displays a stage, it has to be prepared to receive ",(0,r.kt)("inlineCode",{parentName:"p"},"null")," and should not crash."),(0,r.kt)("h2",{id:"list-view-1"},"List view"),(0,r.kt)("p",null,"The information which stage is current assigned to an entity is send as part of the content-type response payload for each entity in the attribute ",(0,r.kt)("inlineCode",{parentName:"p"},"strapi_reviewWorkflows_stage"),".\nPlease see ",(0,r.kt)("a",{parentName:"p",href:"/settings/review-workflows#data-shapes"},"Data Shapes")," for type definitions."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"{\n  // ... entity attributes\n  strapi_reviewWorkflows_stage?: Stage | null\n}\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:1337/content-manager/content-types")," returns whether the feature is enabled for the content-type. ",(0,r.kt)("inlineCode",{parentName:"p"},"options.reviewWorkflows")," is either ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," or undefined."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note"),": Downgrading from EE to CE won't delete the associated review workflow data and ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:1337/content-manager/content-types")," still returns true. The admin app had to\nadd an additional check if the feature toggle returned in ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:1337/admin/project-type")," is enabled."),(0,r.kt)("h2",{id:"edit-view-1"},"Edit View"),(0,r.kt)("p",null,"The information which stage is current assigned to an entity is send as part of the entity response payload in the attribute ",(0,r.kt)("inlineCode",{parentName:"p"},"strapi_reviewWorkflows_stage"),".\nPlease see ",(0,r.kt)("a",{parentName:"p",href:"/settings/review-workflows#data-shapes"},"Data Shapes")," for type definitions."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"{\n  // ... entity attributes\n  strapi_reviewWorkflows_stage?: Stage | null\n}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"undefined"),": the feature is not enabled for this content-type"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"null"),": no stage is assigned to the entity")),(0,r.kt)("h3",{id:"endpoints"},"Endpoints"),(0,r.kt)("h4",{id:"put-admincontent-managerkindcontent-type-uidentity-idstage"},(0,r.kt)("inlineCode",{parentName:"h4"},"PUT /admin/content-manager/[kind]/[content-type-uid]/[entity-id]/stage")),(0,r.kt)("p",null,"Assigns a stage to an entity."),(0,r.kt)("h5",{id:"payload"},"Payload"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"data: {\n  id: int; // assigned stage id\n}\n")))}c.isMDXComponent=!0},3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=d(n),g=r,f=u["".concat(l,".").concat(g)]||u[g]||c[g]||i;return n?a.createElement(f,o(o({ref:t},p),{},{components:n})):a.createElement(f,o({ref:t},p))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var d=2;d<i;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);